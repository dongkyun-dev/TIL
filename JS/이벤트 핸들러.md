# 이벤트 핸들러

> 모던 자바스크립트를 요약하는 글입니다.
>
> 이벤트 핸들러는 이벤트가 발생했을 때 **브라우저**에 호출을 위임한 함수이다. 다시 말해, 이벤트가 발생하면 **브라우저**에 의해 호출될 함수가 이벤트 핸들러이다.
>
> 즉, 이벤트 핸들러를 작동시키는 주체는 브라우저라는 것을 알아야 한다.

---

만약 함수 참조가 아니라 함수 호출문을 등록하게 되면 함수 호출문의 평가 결과가 이벤트 핸들러로 등록된다.

```html
<button onClick="sayHi('Lee')">Click</button>

<script>
	function sayHi(name) {
        console.log(name);
    }
</script>
```

하지만, 위 예제는 이벤트 핸들러 어트리뷰트 값으로 함수 호출문을 할당했다. 이때 이벤트 핸들러 어트리뷰트 값은 사실 암묵적으로 생성될 이벤트 핸들러의 함수 몸체를 의미한다.

즉, `onClick="sayHi('Lee')"` 어트리뷰트는 파싱되어 

```javascript
function onClick(e) {
	sayHi('Lee');
}
```

해당 함수를 암묵적으로 생성하고, 이벤트 핸들러 프로퍼티에 할당한다.

이처럼 동작할 수 있도록 만들어진 이유는 이벤트 핸들러에 인수를 전달하기 위함이다.  만약 이벤트 핸들러 어트리뷰트 값으로 함수 참조를 할당해야 한다면 이벤트 핸들러 함수에 인수를 전달하기 곤란하다.

때문에 다음과 같은 이벤트 핸들러 함수 할당도 가능하다.

```html
<button onClick="console.log('Hi!'); console.log('Hi');">Click me</button>
```

---

### 이벤트를 다는 두가지 방법

- 이벤트 핸들러 프로퍼티에 함수 바인딩

```javascript
const $button = document.querySelector('button');

$button.onClick = function () {
	console.log('test');
}
```

해당 방식의 가장 큰 문제는 이벤트 핸들러 프로퍼티에 하나의 이벤트 핸들러만 바인딩 할 수 있다는 것이다.

- addEventListener 방식 (실질적으로 사용하게 되는 방식)

```javascript
const $button = document.querySelector('button');

$button.addEventListener('click', () => {
	console.log('test');
})
```

addEventListener 메서드는 하나 이상의 이벤트 핸들러를 등록할 수 있다. 이때 이벤트 핸들러는 등록된 순서대로 호출된다.

만일 똑같은 이벤트 핸들러를 중복으로 등록하면 하나만 등록된다.

```javascript
const handleClick = () => console.log('123');

$button.addEventListener('click', handleClick);
$button.addEventListener('click', handleClick);
```

이렇게하면 실질적으로는 하나의 `handleClick`만이 등록된다.

사실 addEventListener에서 가장 중요한 것은 잘 쓰이지 않는 3번째 인자이다.

`EventTarget.addEventListener('eventType', functionName [, useCapture])`

`useCapture`의 자리를 생략하거나 false를 지정하면 버블링 단계에서 이벤트를 캐치, true를 지정하면 캡처링 단계에서 이벤트를 캐치한다. 더 깊은 내용은 이후에 추가한다.

---

### removeEventListener

이벤트 핸들러를 줄 수 있다는건, 제거도 가능하다는 것이다.

하지만, 이벤트 핸들러를 등록할 때 사용했던 인수들을 동일하게 전달해야지만 제거된다.

```javascript
$button.addEventListener('click', handleClick);

$button.removeEventListener('click', handleClick, true)    // 제거 실패(인자의 개수가 다르다)
$button.removeEventListener('click', handleHover, true)    // 제거 실패(인자의 내용이 다르다)
$button.removeEventListener('click', handleClick)    // 제거 성공
```

---

### 이벤트 객체

이벤트 객체는 이벤트가 발생하였을 때, 동적으로 생성된다.

---

### 🔴이벤트 전파

![eventCapture](../assets/img/eventCapture.svg)

캡쳐링 단계

> 이벤트가 상위 요소에서 하위 요소 방향으로 전파

타깃 단계

> 이벤트가 이벤트 타깃에 도달

버블링 단계

> 이벤트가 하위 요소에서 상위 요소 방향으로 전파

https://developer.mozilla.org/ko/docs/Web/API/Event/eventPhase

